{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI Calculator</title>
    <!-- Link to CSS using Django's static tag -->
    <link rel="stylesheet" href="{% static 'css/bmi.css' %}">
</head>
<body>
    <div class="container">
        <div class="brand-name">
            <span class="rgb-text">FITNESS FLOW</span>
        </div>
        <div class="back-button-container">
            <button id="backButton" class="back-button" onclick="window.history.back();">Back</button>
        </div>
        <h1>BMI Calculator</h1>
        
        <div class="unit-switch">
            <label class="switch">
                <input type="checkbox" id="unitToggle">
                <span class="switch-slider"></span>
            </label>
            <span id="unitText">Metric Units</span>
        </div>

        <div id="metric-inputs">
            <div class="slider-container">
                <label>Weight (kg): <span id="weightValue" class="value-display">70</span></label>
                <input type="range" min="30" max="200" value="70" class="slider" id="weight">
            </div>

            <div class="slider-container">
                <label>Height (cm): <span id="heightValue" class="value-display">170</span></label>
                <input type="range" min="100" max="220" value="170" class="slider" id="height">
            </div>
        </div>

        <div id="imperial-inputs" style="display: none;">
            <div class="slider-container">
                <label>Weight (lbs): <span id="weightValueImp" class="value-display">154</span></label>
                <input type="range" min="66" max="440" value="154" class="slider" id="weightImp">
            </div>

            <div class="slider-container">
                <label>Height (ft): <span id="heightValueFt" class="value-display">5</span></label>
                <input type="range" min="3" max="8" value="5" class="slider" id="heightFt">
            </div>

            <div class="slider-container">
                <label>Height (in): <span id="heightValueIn" class="value-display">7</span></label>
                <input type="range" min="0" max="11" value="7" class="slider" id="heightIn">
            </div>
        </div>

        <div id="result" class="result">
            Your BMI: 24.22 (Normal)
        </div>
    </div>

    <script>
        const unitToggle = document.getElementById('unitToggle');
        const metricInputs = document.getElementById('metric-inputs');
        const imperialInputs = document.getElementById('imperial-inputs');
        const unitText = document.getElementById('unitText');

        unitToggle.addEventListener('change', function() {
            if (this.checked) {
                metricInputs.style.display = 'none';
                imperialInputs.style.display = 'block';
                unitText.textContent = 'Imperial Units';
            } else {
                metricInputs.style.display = 'block';
                imperialInputs.style.display = 'none';
                unitText.textContent = 'Metric Units';
            }
            calculateBMI();
        });

        function calculateBMI() {
            let weight, height, bmi;
            
            if (unitToggle.checked) {
                // Imperial calculations
                const weightLbs = document.getElementById('weightImp').value;
                const heightFt = document.getElementById('heightFt').value;
                const heightIn = document.getElementById('heightIn').value;
                
                // Convert to metric for BMI calculation
                weight = weightLbs * 0.453592; // lbs to kg
                height = ((heightFt * 12) + parseInt(heightIn)) * 0.0254; // inches to meters
                
                // Update imperial display values
                document.getElementById('weightValueImp').textContent = weightLbs;
                document.getElementById('heightValueFt').textContent = heightFt;
                document.getElementById('heightValueIn').textContent = heightIn;
            } else {
                // Metric calculations
                weight = document.getElementById('weight').value;
                height = document.getElementById('height').value / 100; // cm to meters
                
                // Update metric display values
                document.getElementById('weightValue').textContent = weight;
                document.getElementById('heightValue').textContent = height * 100;
            }
            
            bmi = (weight / (height * height)).toFixed(2);
            
            let category, color;
            
            if (bmi < 18.5) {
                category = "Underweight";
                color = "#87CEEB";
            } else if (bmi < 25) {
                category = "Normal";
                color = "#90EE90";
            } else if (bmi < 30) {
                category = "Overweight";
                color = "#FFD700";
            } else {
                category = "Obese";
                color = "#FF6B6B";
            }

            document.getElementById('result').textContent = `Your BMI: ${bmi} (${category})`;
            document.getElementById('result').style.backgroundColor = color;
        }

        // Add event listeners to all sliders
        const sliders = ['weight', 'height', 'weightImp', 'heightFt', 'heightIn'];
        sliders.forEach(slider => {
            document.getElementById(slider).addEventListener('input', calculateBMI);
        });

        // Calculate initial BMI
        calculateBMI();
    </script>
</body>
</html>
